<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="gdtcs.day.mapper.DayMapper">
<select id="selectDayFinList" parameterType="Map" resultType="Map">
		<![CDATA[
			SELECT
			    ROW_NUMBER() OVER(ORDER BY DAY.DATES, WS.WORK_DATE ,WS.WORK_NO) AS ROW_NUM,
			    NVL(WS.WORKER_NO, '-') as WORKER_NO,
			    NVL(FC_CHG_WORKERNM(#{IC_CODE}, WS.WORKER_NO), '-') as WORKER_NM,
			    FC_CHG_FORMAT(DAY.DATES,'1') AS WORK_DATE,
			    NVL(WS.WORK_NO, '-') as WORK_NO,
			    DECODE(WS.WORK_DIV, '0', '일반근무', '1', '유지보수', '-') as WORK_DIV,
			    DECODE(WS.WORK_FIN_STAT, '1', '개시', '3', '종료', '5', '마감', '7', '수정', '-') as WORK_STATE,
			    DECODE(WS.END_DIV,'0', '미종료', '1', '종료', '2', '강제종료', '-') as END_STATE,
			    DECODE(DFM.HAND_DT, NULL, DECODE(DFI.DAY_FIN_PROC_DT, NULL, '미완료', '일마감완료'), DECODE(DFI.DAY_FIN_PROC_DT, NULL, '일마감취소', '일마감완료')) as DAY_FIN_STATE,
			    DECODE(DFL.lock_div, '1', '일마감 LOCK', '2', 'LOCK 해제', 'LOCK 미지정') as LOCK_STATE,
			    NVL(FC_CHG_FORMAT(DFI.DAY_FIN_PROC_DT, '11'), '-') as DAY_FIN_PROC_DT,
			    NVL(FC_CHG_FORMAT(WS.START_DT, '11'), '-') as START_DT,
			    NVL(FC_CHG_FORMAT(WS.END_DT, '11'), '-') as END_DT
			FROM
			    (SELECT TO_CHAR(TO_DATE(#{START_DATE},'YYYYMMDD') + LEVEL -1, 'YYYYMMDD') DATES FROM DUAL CONNECT BY LEVEL <= TO_DATE(#{END_DATE}, 'yyyymmdd') - TO_DATE(#{START_DATE}, 'yyyymmdd') + 1) DAY LEFT JOIN PRIM_WORKSTAT WS
			    ON DAY.DATES = WS.WORK_DATE AND WS.IC_CODE =#{IC_CODE} LEFT JOIN PROC_DAYFININFO DFI
			    ON WS.WORK_DATE = DFI.WORK_DATE AND WS.IC_CODE = DFI.IC_CODE AND DFI.IC_DIV = (SELECT IC_DIV FROM BASE_LANEINFO WHERE  SUBSTR(WS.WORK_NO,1,2) = LOGC_LANE) 
			    LEFT JOIN 
			    (            
			    	SELECT B.*
		            FROM
		            (SELECT IC_CODE, WORK_DATE, MAX(MDFY_NO) AS MDFY_NO
		            FROM PROC_DAYFINMDFY 
		            GROUP BY IC_CODE, WORK_DATE) A LEFT JOIN PROC_DAYFINMDFY B ON A.IC_CODE =B.IC_CODE AND A.WORK_DATE = B.WORK_DATE AND A.MDFY_NO = B.MDFY_NO
	            ) DFM ON WS.WORK_DATE = DFM.WORK_DATE AND WS.IC_CODE = DFM.IC_CODE 
	            LEFT JOIN 
	            (
		            SELECT B.*
		            FROM
		            (SELECT IC_CODE, WORK_DATE, MAX(REV_NO) AS REV_NO
		            FROM PROC_DAYFINLOCK 
		            GROUP BY IC_CODE, WORK_DATE) A LEFT JOIN PROC_DAYFINLOCK B ON A.IC_CODE =B.IC_CODE AND A.WORK_DATE = B.WORK_DATE AND A.REV_NO = B.REV_NO
	            ) DFL ON WS.WORK_DATE = DFL.WORK_DATE AND WS.IC_CODE = DFL.IC_CODE
			ORDER BY DAY.DATES, WS.WORK_DATE ,WS.WORK_NO
		]]>
	</select>
	
	<select id="selectDayFinMdfyList" parameterType="Map" resultType="Map">
		SELECT 
			ROWNUM AS ROW_NUM,
			FC_CHG_FORMAT(DFM.WORK_DATE, '1') AS WORK_DATE,
			NVL(DFM.WORKER_NO, '-') AS WORKER_NO,
			NVL(FC_CHG_WORKERNM(#{IC_CODE}, DFM.WORKER_NO), '-') as WORKER_NM,
			NVL(TO_CHAR(TO_DATE(DFM.HAND_DT, 'YYYYMMDDHH24MISS'), 'YYYY-MM-DD HH24:MI:SS'), '-') AS HAND_DT,
			NVL(DFM.MDFY_RES, '-') AS MDFY_RES,
			DFM.MDFY_NO
		FROM PROC_DAYFINMDFY DFM
		WHERE IC_CODE = #{IC_CODE} AND WORK_DATE BETWEEN #{START_DATE} AND #{END_DATE}
	</select>
	
	<select id="selectDayFinLockList" parameterType="Map" resultType="Map">
	    SELECT ROW_NUMBER() OVER(ORDER BY DFL.WORK_DATE) AS ROW_NUM,
            DFL.IC_CODE,
            FC_CHG_FORMAT(DFL.WORK_DATE, '1') AS WORK_DATE,
            FC_CHG_FORMAT(DFL.LOCK_OCC_DT, '11') as LOCK_OCC_DT,
            NVL(DFL.ADMIN_ID,'-') AS ADMIN_ID,
			NVL(FC_CHG_WORKERNM(#{IC_CODE}, DFL.ADMIN_ID), '-') as ADMIN_ID_NM,
            NVL(DFL.REV_NO, 0) AS REV_NO,
            DECODE(DFL.LOCK_DIV, '1', '일마감 LOCK', '2', 'LOCK 해제', '-') AS LOCK_STATE,
            NVL(DFL.NOTE, '-') AS NOTE
		FROM PROC_DAYFINLOCK DFL JOIN (SELECT IC_CODE, WORK_DATE, MAX(REV_NO) AS REV_NO FROM PROC_DAYFINLOCK WHERE IC_CODE = #{IC_CODE} AND WORK_DATE BETWEEN #{START_DATE} AND #{END_DATE} GROUP BY IC_CODE, WORK_DATE) DFLS
        ON DFL.IC_CODE = DFLS.IC_CODE AND DFL.WORK_DATE = DFLS.WORK_DATE AND DFL.REV_NO = DFLS.REV_NO
		ORDER BY DFL.WORK_DATE
	</select>
	
	<select id="selectDayFinUnlockList" parameterType="Map" resultType="Map">
		SELECT ROW_NUMBER() OVER(ORDER BY WORK_DATE, REV_NO) AS ROW_NUM,
			DFL.IC_CODE,
			FC_CHG_FORMAT(DFL.WORK_DATE, '1') AS WORK_DATE,
			FC_CHG_FORMAT(DFL.LOCK_OCC_DT, '11') as LOCK_OCC_DT,
			NVL(DFL.ADMIN_ID,'-') AS ADMIN_ID,
			NVL(FC_CHG_WORKERNM(#{IC_CODE}, DFL.ADMIN_ID), '-') as ADMIN_ID_NM,
			NVL(DFL.REV_NO, 0) AS REV_NO,
			NVL(DFL.NOTE, '-') AS NOTE
		FROM PROC_DAYFINLOCK DFL
		WHERE  
			DFL.IC_CODE = #{IC_CODE}
		    AND DFL.LOCK_DIV = '2'
		    AND DFL.WORK_DATE BETWEEN #{START_DATE} AND #{END_DATE}
		ORDER BY WORK_DATE, REV_NO
	</select>

	<select id="selectDayFinReport" parameterType="Map" resultType="Map">
		SELECT
			-- 현금수입
			NVL(FC_CHG_FORMAT(SUM(OFC_FARE), 4), 0) AS OFC_FARE,
			NVL(FC_CHG_FORMAT(SUM(OFC_CNT), 4), 0) AS OFC_CNT,
			-- 차로제어기(선후불)
			NVL(FC_CHG_FORMAT(SUM(TCS_EPCARD_FARE), 4), 0) AS TCS_EPCARD_FARE,
			NVL(FC_CHG_FORMAT(SUM(TCS_ELCARD_FARE), 4), 0) AS TCS_ELCARD_FARE,
			NVL(FC_CHG_FORMAT(SUM(TCS_EPCARD_CNT), 4), 0) AS TCS_EPCARD_CNT,
			NVL(FC_CHG_FORMAT(SUM(TCS_ELCARD_CNT), 4), 0) AS TCS_ELCARD_CNT,
			-- 환불금 
			NVL(FC_CHG_FORMAT(SUM(EXMT_RFND_EX_FARE), 4), 0) AS EXMT_RFND_EX_FARE,
			NVL(FC_CHG_FORMAT(SUM(EXMT_RFND_BUSAN_FARE), 4), 0) AS EXMT_RFND_BUSAN_FARE,
			-- 공차택시    
			NVL(FC_CHG_FORMAT(SUM(EMPTY_TAXI), 4), 0) AS EMPTY_TAXI,
			NVL(FC_CHG_FORMAT(SUM(EMPTY_TAXI_NON), 4), 0) AS EMPTY_TAXI_NON,
			-- 현금 하이패스(완납)
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_FARE_LIGHT), 4), 0) AS VLTN_PAY_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_FARE_SMALL), 4), 0) AS VLTN_PAY_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_FARE_BIG), 4), 0) AS VLTN_PAY_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_FARE_SPECIAL), 4), 0) AS VLTN_PAY_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_CNT_LIGHT), 4), 0) AS VLTN_PAY_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_CNT_SMALL), 4), 0) AS VLTN_PAY_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_CNT_BIG), 4), 0) AS VLTN_PAY_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_CNT_SPECIAL), 4), 0) AS VLTN_PAY_CNT_SPECIAL,
			-- 선불 .하이패스    
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_FARE_LIGHT), 4), 0) AS LANE_EPCARD_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_FARE_SMALL), 4), 0) AS LANE_EPCARD_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_FARE_BIG), 4), 0) AS LANE_EPCARD_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_FARE_SPECIAL), 4), 0) AS LANE_EPCARD_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_CNT_LIGHT), 4), 0) AS LANE_EPCARD_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_CNT_SMALL), 4), 0) AS LANE_EPCARD_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_CNT_BIG), 4), 0) AS LANE_EPCARD_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_CNT_SPECIAL), 4), 0) AS LANE_EPCARD_CNT_SPECIAL,
			-- 선불.차로제어기, TCS_EPCARD_FARE
			-- 후불 .하이패스    
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_FARE_LIGHT), 4), 0) AS LANE_ELCARD_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_FARE_SMALL), 4), 0) AS LANE_ELCARD_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_FARE_BIG), 4), 0) AS LANE_ELCARD_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_FARE_SPECIAL), 4), 0) AS LANE_ELCARD_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_CNT_LIGHT), 4), 0) AS LANE_ELCARD_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_CNT_SMALL), 4), 0) AS LANE_ELCARD_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_CNT_BIG), 4), 0) AS LANE_ELCARD_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_CNT_SPECIAL), 4), 0) AS LANE_ELCARD_CNT_SPECIAL,
			-- 후불.차로제어기, TCS_ELCARD_FARE
			-- 사전등록       
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_FARE_LIGHT), 4), 0) AS VLTN_PRE_REG_FARE_LIGHT, 
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_FARE_SMALL), 4), 0) AS VLTN_PRE_REG_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_FARE_BIG), 4), 0) AS VLTN_PRE_REG_FARE_BIG, 
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_FARE_SPECIAL), 4), 0) AS VLTN_PRE_REG_FARE_SPECIAL, 
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_CNT_LIGHT), 4), 0) AS VLTN_PRE_REG_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_CNT_SMALL), 4), 0) AS VLTN_PRE_REG_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_CNT_BIG), 4), 0) AS VLTN_PRE_REG_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_CNT_SPECIAL), 4), 0) AS VLTN_PRE_REG_CNT_SPECIAL,
			-- 면제.하이패스  
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_FARE_LIGHT), 4), 0) AS EXMT_HIPASS_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_FARE_SMALL), 4), 0) AS EXMT_HIPASS_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_FARE_BIG), 4), 0) AS EXMT_HIPASS_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_FARE_SPECIAL), 4), 0) AS EXMT_HIPASS_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_CNT_LIGHT), 4), 0) AS EXMT_HIPASS_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_CNT_SMALL), 4), 0) AS EXMT_HIPASS_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_CNT_BIG), 4), 0) AS EXMT_HIPASS_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_CNT_SPECIAL), 4), 0) AS EXMT_HIPASS_CNT_SPECIAL,
			-- 면제.선불출금
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_FARE_LIGHT), 4), 0) AS EXMT_EPCARD_PAY_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_FARE_SMALL), 4), 0) AS EXMT_EPCARD_PAY_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_FARE_BIG), 4), 0) AS EXMT_EPCARD_PAY_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_FARE_SPECIAL), 4), 0) AS EXMT_EPCARD_PAY_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_CNT_LIGHT), 4), 0) AS EXMT_EPCARD_PAY_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_CNT_SMALL), 4), 0) AS EXMT_EPCARD_PAY_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_CNT_BIG), 4), 0) AS EXMT_EPCARD_PAY_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_CNT_SPECIAL), 4), 0) AS EXMT_EPCARD_PAY_CNT_SPECIAL,
			-- 면제.부산시      
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_FARE_LIGHT), 4), 0) AS EXMT_BUSAN_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_FARE_SMALL), 4), 0) AS EXMT_BUSAN_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_FARE_BIG), 4), 0) AS EXMT_BUSAN_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_FARE_SPECIAL), 4), 0) AS EXMT_BUSAN_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_CNT_LIGHT), 4), 0) AS EXMT_BUSAN_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_CNT_SMALL), 4), 0) AS EXMT_BUSAN_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_CNT_BIG), 4), 0) AS EXMT_BUSAN_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_CNT_SPECIAL), 4), 0) AS EXMT_BUSAN_CNT_SPECIAL,
			-- 면제.선불출금.부산시
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_FARE_LIGHT), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_FARE_SMALL), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_FARE_BIG), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_FARE_SPECIAL), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_CNT_LIGHT), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_CNT_SMALL), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_CNT_BIG), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_CNT_SPECIAL), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_SPECIAL,
			-- 사무실(미납)    
			NVL(FC_CHG_FORMAT(SUM(UNP_FARE_LIGHT), 4), 0) AS UNP_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(UNP_FARE_SMALL), 4), 0) AS UNP_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(UNP_FARE_BIG), 4), 0) AS UNP_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(UNP_FARE_SPECIAL), 4), 0) AS UNP_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(UNP_CNT_LIGHT), 4), 0) AS UNP_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(UNP_CNT_SMALL), 4), 0) AS UNP_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(UNP_CNT_BIG), 4), 0) AS UNP_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(UNP_CNT_SPECIAL), 4), 0) AS UNP_CNT_SPECIAL,
			-- 수수료
			NVL(MAX(CMS_EPCARD),0) AS CMS_EPCARD,
			NVL(MAX(CMS_ELCARD),0) AS CMS_ELCARD,
			NVL(MAX(CMS_CARD),0) AS CMS_CARD
		FROM 
		(
		    SELECT
		        IC_CODE, 
				WORK_DATE,
				IC_DIV,
		        -- 현금수입
		        SUM(OFC_PAY_FARE) - SUM(OFC_RFND_FARE) AS OFC_FARE,
		        SUM(OFC_PAY_CNT) - SUM(OFC_RFND_CNT) AS OFC_CNT,
		        -- 차로제어기
		        SUM(TCS_EPCARD_FARE) AS TCS_EPCARD_FARE,
		        SUM(TCS_ELCARD_FARE) AS TCS_ELCARD_FARE,
		        SUM(TCS_EPCARD_CNT) AS TCS_EPCARD_CNT,
		        SUM(TCS_ELCARD_CNT) AS TCS_ELCARD_CNT,
		        -- 환불금
		        SUM(EXMT_RFND_EX_FARE) AS EXMT_RFND_EX_FARE,
		        SUM(EXMT_RFND_BUSAN_FARE) AS EXMT_RFND_BUSAN_FARE,
		        -- 공차택시
		        SUM(EMPTY_TAXI_CNT) AS EMPTY_TAXI,
		        SUM(EMPTY_TAXI_NON_CNT) AS EMPTY_TAXI_NON,
		        -- 수수료
		        (MAX(CMS_EPCARD)/100) AS CMS_EPCARD,
		        (MAX(CMS_ELCARD)/100) AS CMS_ELCARD,
		        (MAX(CMS_CARD)/100) AS CMS_CARD
		    FROM PROC_DAYFININFO 
		    WHERE IC_CODE = #{IC_CODE} 
	        <choose>
    			 <when test="START_DATE != NULL and END_DATE != NULL">
	        		AND WORK_DATE BETWEEN #{START_DATE} AND #{END_DATE}
	        	</when>
	        	<when test="YEAR != NULL">
	        		AND WORK_DATE BETWEEN #{YEAR} AND #{WORK_DATE}
	        	</when>
	        	<when test = "MONTH != NULL">
	        		AND WORK_DATE BETWEEN #{MONTH} AND #{WORK_DATE}
	        	</when>
	        	<otherwise>
		    		AND WORK_DATE = #{WORK_DATE}
	        	</otherwise>
	        </choose> 
		    GROUP BY IC_CODE, WORK_DATE, IC_DIV
		) DFI LEFT JOIN 
		(
		    SELECT
		        NVL(FARE.IC_CODE, CNT.IC_CODE) AS IC_CODE,
			    NVL(FARE.WORK_DATE, CNT.WORK_DATE) AS WORK_DATE,
			    NVL(FARE.IC_DIV, CNT.IC_DIV) AS IC_DIV,
		        -- 현금. 하이패스(완납)
		        SUM(VLTN_PAY_FARE_6) AS VLTN_PAY_FARE_LIGHT,
		        SUM(VLTN_PAY_FARE_1) AS VLTN_PAY_FARE_SMALL,
		        SUM(VLTN_PAY_FARE_2) AS VLTN_PAY_FARE_BIG,
		        SUM(VLTN_PAY_FARE_3) + SUM(VLTN_PAY_FARE_4) + SUM(VLTN_PAY_FARE_5) AS VLTN_PAY_FARE_SPECIAL,
		        SUM(VLTN_PAY_CNT_6) AS VLTN_PAY_CNT_LIGHT,
		        SUM(VLTN_PAY_CNT_1) AS VLTN_PAY_CNT_SMALL,
		        SUM(VLTN_PAY_CNT_2) AS VLTN_PAY_CNT_BIG,
		        SUM(VLTN_PAY_CNT_3) + SUM(VLTN_PAY_CNT_4) + SUM(VLTN_PAY_CNT_5)  AS VLTN_PAY_CNT_SPECIAL,
		        -- 선불.하이패스,
		        SUM(LANE_EPCARD_FARE_6) AS LANE_EPCARD_FARE_LIGHT,
		        SUM(LANE_EPCARD_FARE_1) AS LANE_EPCARD_FARE_SMALL,
		        SUM(LANE_EPCARD_FARE_2) AS LANE_EPCARD_FARE_BIG,
		        SUM(LANE_EPCARD_FARE_3) + SUM(LANE_EPCARD_FARE_4) + SUM(LANE_EPCARD_FARE_5) AS LANE_EPCARD_FARE_SPECIAL,
		        SUM(LANE_EPCARD_CNT_6) AS LANE_EPCARD_CNT_LIGHT,
		        SUM(LANE_EPCARD_CNT_1) AS LANE_EPCARD_CNT_SMALL,
		        SUM(LANE_EPCARD_CNT_2) AS LANE_EPCARD_CNT_BIG,
		        SUM(LANE_EPCARD_CNT_3) + SUM(LANE_EPCARD_CNT_4) + SUM(LANE_EPCARD_CNT_5) AS LANE_EPCARD_CNT_SPECIAL,
		        -- 후불.하이패스
		        SUM(LANE_ELCARD_FARE_6) AS LANE_ELCARD_FARE_LIGHT,
		        SUM(LANE_ELCARD_FARE_1) AS LANE_ELCARD_FARE_SMALL,
		        SUM(LANE_ELCARD_FARE_2) AS LANE_ELCARD_FARE_BIG,
		        SUM(LANE_ELCARD_FARE_3) + SUM(LANE_ELCARD_FARE_4) + SUM(LANE_ELCARD_FARE_5) AS LANE_ELCARD_FARE_SPECIAL,
		        SUM(LANE_ELCARD_CNT_6) AS LANE_ELCARD_CNT_LIGHT,
		        SUM(LANE_ELCARD_CNT_1) AS LANE_ELCARD_CNT_SMALL,
		        SUM(LANE_ELCARD_CNT_2) AS LANE_ELCARD_CNT_BIG,
		        SUM(LANE_ELCARD_CNT_3) + SUM(LANE_ELCARD_CNT_4) + SUM(LANE_ELCARD_CNT_5) AS LANE_ELCARD_CNT_SPECIAL,
		        -- 사전등록
		        SUM(VLTN_PRE_REG_FARE_6) AS VLTN_PRE_REG_FARE_LIGHT,
		        SUM(VLTN_PRE_REG_FARE_1) AS VLTN_PRE_REG_FARE_SMALL,
		        SUM(VLTN_PRE_REG_FARE_2) AS VLTN_PRE_REG_FARE_BIG,
		        SUM(VLTN_PRE_REG_FARE_3) + SUM(VLTN_PRE_REG_FARE_4) + SUM(VLTN_PRE_REG_FARE_5) AS VLTN_PRE_REG_FARE_SPECIAL,
		        SUM(VLTN_PRE_REG_CNT_6) AS VLTN_PRE_REG_CNT_LIGHT,
		        SUM(VLTN_PRE_REG_CNT_1) AS VLTN_PRE_REG_CNT_SMALL,
		        SUM(VLTN_PRE_REG_CNT_2) AS VLTN_PRE_REG_CNT_BIG,
		        SUM(VLTN_PRE_REG_CNT_3) + SUM(VLTN_PRE_REG_CNT_4) + SUM(VLTN_PRE_REG_CNT_5) AS VLTN_PRE_REG_CNT_SPECIAL,
		        -- 면제.하이패스
		        SUM(EXMT_HIPASS_FARE_6) AS EXMT_HIPASS_FARE_LIGHT,
		        SUM(EXMT_HIPASS_FARE_1) AS EXMT_HIPASS_FARE_SMALL,
		        SUM(EXMT_HIPASS_FARE_2) AS EXMT_HIPASS_FARE_BIG,
		        SUM(EXMT_HIPASS_FARE_3) + SUM(EXMT_HIPASS_FARE_4) + SUM(EXMT_HIPASS_FARE_5) AS EXMT_HIPASS_FARE_SPECIAL,
		        SUM(EXMT_HIPASS_CNT_6) AS EXMT_HIPASS_CNT_LIGHT,
		        SUM(EXMT_HIPASS_CNT_1) AS EXMT_HIPASS_CNT_SMALL,
		        SUM(EXMT_HIPASS_CNT_2) AS EXMT_HIPASS_CNT_BIG,
		        SUM(EXMT_HIPASS_CNT_3) + SUM(EXMT_HIPASS_CNT_4) + SUM(EXMT_HIPASS_CNT_5) AS EXMT_HIPASS_CNT_SPECIAL,
				-- 면제.선불출금
				SUM(EXMT_EPCARD_PAY_FARE_6) AS EXMT_EPCARD_PAY_FARE_LIGHT,
				SUM(EXMT_EPCARD_PAY_FARE_1) AS EXMT_EPCARD_PAY_FARE_SMALL,
				SUM(EXMT_EPCARD_PAY_FARE_2) AS EXMT_EPCARD_PAY_FARE_BIG,
				SUM(EXMT_EPCARD_PAY_FARE_3) + SUM(EXMT_EPCARD_PAY_FARE_4) + SUM(EXMT_EPCARD_PAY_FARE_5) AS EXMT_EPCARD_PAY_FARE_SPECIAL,
				SUM(EXMT_EPCARD_PAY_CNT_6) AS EXMT_EPCARD_PAY_CNT_LIGHT,
				SUM(EXMT_EPCARD_PAY_CNT_1) AS EXMT_EPCARD_PAY_CNT_SMALL,
				SUM(EXMT_EPCARD_PAY_CNT_2) AS EXMT_EPCARD_PAY_CNT_BIG,
				SUM(EXMT_EPCARD_PAY_CNT_3) + SUM(EXMT_EPCARD_PAY_CNT_4) + SUM(EXMT_EPCARD_PAY_CNT_5) AS EXMT_EPCARD_PAY_CNT_SPECIAL,
		        -- 면제.부산시
		        SUM(EXMT_BUSAN_FARE_6) AS EXMT_BUSAN_FARE_LIGHT,
		        SUM(EXMT_BUSAN_FARE_1) AS EXMT_BUSAN_FARE_SMALL,
		        SUM(EXMT_BUSAN_FARE_2) AS EXMT_BUSAN_FARE_BIG,
		        SUM(EXMT_BUSAN_FARE_3) + SUM(EXMT_BUSAN_FARE_4) + SUM(EXMT_BUSAN_FARE_5) AS EXMT_BUSAN_FARE_SPECIAL,
		        SUM(EXMT_BUSAN_CNT_6) AS EXMT_BUSAN_CNT_LIGHT,
		        SUM(EXMT_BUSAN_CNT_1) AS EXMT_BUSAN_CNT_SMALL,
		        SUM(EXMT_BUSAN_CNT_2) AS EXMT_BUSAN_CNT_BIG,
		        SUM(EXMT_BUSAN_CNT_3) + SUM(EXMT_BUSAN_CNT_4) + SUM(EXMT_BUSAN_CNT_5) AS EXMT_BUSAN_CNT_SPECIAL,
				-- 면제.선불출금.부산시
				SUM(EXMT_EPCARD_PAY_BUSAN_FARE_6) AS EXMT_EPCARD_PAY_BUSAN_FARE_LIGHT,
				SUM(EXMT_EPCARD_PAY_BUSAN_FARE_1) AS EXMT_EPCARD_PAY_BUSAN_FARE_SMALL,
				SUM(EXMT_EPCARD_PAY_BUSAN_FARE_2) AS EXMT_EPCARD_PAY_BUSAN_FARE_BIG,
				SUM(EXMT_EPCARD_PAY_BUSAN_FARE_3) + SUM(EXMT_EPCARD_PAY_BUSAN_FARE_4) + SUM(EXMT_EPCARD_PAY_BUSAN_FARE_5) AS EXMT_EPCARD_PAY_BUSAN_FARE_SPECIAL,
				SUM(EXMT_EPCARD_PAY_BUSAN_CNT_6) AS EXMT_EPCARD_PAY_BUSAN_CNT_LIGHT,
				SUM(EXMT_EPCARD_PAY_BUSAN_CNT_1) AS EXMT_EPCARD_PAY_BUSAN_CNT_SMALL,
				SUM(EXMT_EPCARD_PAY_BUSAN_CNT_2) AS EXMT_EPCARD_PAY_BUSAN_CNT_BIG,
				SUM(EXMT_EPCARD_PAY_BUSAN_CNT_3) + SUM(EXMT_EPCARD_PAY_BUSAN_CNT_4) + SUM(EXMT_EPCARD_PAY_BUSAN_CNT_5) AS EXMT_EPCARD_PAY_BUSAN_CNT_SPECIAL,
		        -- 사무실(미납)
		        SUM(UNP_FARE_6) AS UNP_FARE_LIGHT,
		        SUM(UNP_FARE_1) AS UNP_FARE_SMALL,
		        SUM(UNP_FARE_2) AS UNP_FARE_BIG,
		        SUM(UNP_FARE_3) + SUM(UNP_FARE_4) + SUM(UNP_FARE_5) AS UNP_FARE_SPECIAL,
		        SUM(UNP_CNT_6) AS UNP_CNT_LIGHT,
		        SUM(UNP_CNT_1) AS UNP_CNT_SMALL,
		        SUM(UNP_CNT_2) AS UNP_CNT_BIG,
		        SUM(UNP_CNT_3) + SUM(UNP_CNT_4) + SUM(UNP_CNT_5) AS UNP_CNT_SPECIAL
		    FROM
		    (
		        SELECT 
		            IC_CODE,
		            WORK_DATE,
		            IC_DIV,
		            DFT_CAR_TYPE,
		            -- 현금.하이패스(완납)
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_6,
		            -- 선불.하이패스
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_6,
		            -- 후불.하이패스,
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_6,
		            -- 사전등록
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_6,
		            -- 면제.하이패스
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_CNT_6,
					-- 면제.선불출금
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_6,
		            -- 면제.부산시
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_CNT_6,
					-- 면제.선불출금.부산시
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_6,
		            -- 사무실(미납)
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_6
		        FROM
		            PROC_DAYFINPAYTOT
		        WHERE IC_CODE = #{IC_CODE}
					<choose>
	       			 	<when test="START_DATE != NULL and END_DATE != NULL">
			        		AND WORK_DATE BETWEEN #{START_DATE} AND #{END_DATE}
			        	</when>
			        	<when test="YEAR != NULL">
			        		AND WORK_DATE BETWEEN #{YEAR} AND #{WORK_DATE}
			        	</when>
			        	<when test = "MONTH != NULL">
			        		AND WORK_DATE BETWEEN #{MONTH} AND #{WORK_DATE}
			        	</when>
			        	<otherwise>
				    		AND WORK_DATE = #{WORK_DATE}
			        	</otherwise>
			        </choose>
			        AND SUM_DIV = '0'
		        GROUP BY IC_CODE, WORK_DATE, IC_DIV, DFT_CAR_TYPE
		    ) CNT LEFT JOIN
	     	(
	        	SELECT 
		            IC_CODE,
		            WORK_DATE,
		            IC_DIV,
		            DFT_CAR_TYPE,
		            -- 현금.하이패스(완납)
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_6,
		            -- 선불.하이패스
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_6,
		            -- 후불.하이패스
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_6,
		            -- 사전등록
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_6,
		            -- 면제.하이패스
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_OBU_ETC) + SUM(LANE_EXEM_CARD_ETC) + SUM(VLTN_EXMT), 0) AS EXMT_HIPASS_FARE_6,
					-- 면제.선불출금
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_6,
		            -- 면제.부산시
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_BUSAN_ETC) + SUM(VLTN_EXMT_BUSAN),0) AS EXMT_BUSAN_FARE_6,
					-- 면제.선불출금.부산시
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_6,
		            -- 사무실(미납)
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_6
		        FROM
		            PROC_DAYFINPAYTOT
		        WHERE IC_CODE = #{IC_CODE} 
					<choose>
	       			 	<when test="START_DATE != NULL and END_DATE != NULL">
			        		AND WORK_DATE BETWEEN #{START_DATE} AND #{END_DATE}
			        	</when>
			        	<when test="YEAR != NULL">
			        		AND WORK_DATE BETWEEN #{YEAR} AND #{WORK_DATE}
			        	</when>
			        	<when test = "MONTH != NULL">
			        		AND WORK_DATE BETWEEN #{MONTH} AND #{WORK_DATE}
			        	</when>
			        	<otherwise>
				    		AND WORK_DATE = #{WORK_DATE}
		        		</otherwise>
			        </choose>
			        AND SUM_DIV = '1'
		        GROUP BY IC_CODE, WORK_DATE, IC_DIV, DFT_CAR_TYPE
		    ) FARE ON FARE.IC_CODE = CNT.IC_CODE AND FARE.WORK_DATE = CNT.WORK_DATE AND FARE.DFT_CAR_TYPE = CNT.DFT_CAR_TYPE AND FARE.IC_DIV = CNT.IC_DIV
		    GROUP BY FARE.IC_CODE, FARE.WORK_DATE, CNT.IC_CODE, CNT.WORK_DATE, FARE.IC_DIV, CNT.IC_DIV
		) DFT ON DFI.IC_CODE = DFT.IC_CODE AND DFI.WORK_DATE = DFT.WORK_DATE AND DFI.IC_DIV = DFT.IC_DIV
		<if test='IC_DIV!=null and !IC_DIV.equals("")'>
			WHERE DFI.IC_DIV = #{IC_DIV}
		</if>
		GROUP BY DFI.IC_CODE
	</select>
	
	<resultMap id="resultDayFin" type="hashMap"/>
	<insert id="insertDayFin" statementType="CALLABLE" parameterType="Map">
	{
		CALL SP_DAYFIN_INIT(
		#{IC_CODE, mode=IN, jdbcType=VARCHAR},
		#{WORK_DATE, mode=IN, jdbcType=VARCHAR},
		#{WORKER_NO, mode=IN, jdbcType=VARCHAR},
	 	#{O_CURSOR, mode=OUT, jdbcType=CURSOR, javaType=ResultSet, resultMap=resultDayFin}
		)	
	}
	</insert>
	
	<resultMap id="resultDayFinCancel" type="hashMap"/>
	<insert id="insertDayFinCancel" statementType="CALLABLE" parameterType="Map">
	{
		CALL SP_DAYFIN_CANCEL(
		#{IC_CODE, mode=IN, jdbcType=VARCHAR},
		#{WORK_DATE, mode=IN, jdbcType=VARCHAR},
		#{WORKER_NO, mode=IN, jdbcType=VARCHAR},
		#{COMMENT, mode=IN, jdbcType=VARCHAR},
	 	#{O_CURSOR, mode=OUT, jdbcType=CURSOR, javaType=ResultSet, resultMap=resultDayFin}
		)	
	}
	</insert>
	
	<resultMap id="resultDayFinLock" type="hashMap"/>
	<insert id="insertDayFinLock" statementType="CALLABLE" parameterType="Map">
	{
		CALL SP_DAYFIN_LOCK(
		#{IC_CODE, mode=IN, jdbcType=VARCHAR},
		#{WORK_DATE, mode=IN, jdbcType=VARCHAR},
		#{ADMIN_ID, mode=IN, jdbcType=VARCHAR},
	 	#{O_CURSOR, mode=OUT, jdbcType=CURSOR, javaType=ResultSet, resultMap=resultDayFinLock}
		)
	} 
	</insert>
	
	<resultMap id="resultDayFinUnlock" type="hashMap"/>
	<insert id="insertDayFinUnlock" statementType="CALLABLE" parameterType="Map">
	{
		CALL SP_DAYFIN_UNLOCK(
		#{IC_CODE, mode=IN, jdbcType=VARCHAR},
		#{WORK_DATE, mode=IN, jdbcType=VARCHAR},
		#{ADMIN_ID, mode=IN, jdbcType=VARCHAR},
		#{COMMENT, mode=IN, jdbcType=VARCHAR},
	 	#{O_CURSOR, mode=OUT, jdbcType=CURSOR, javaType=ResultSet, resultMap=resultDayFinUnlock}
		)
	} 
	</insert>
	<select id="selectDayFinReportNew" parameterType="Map" resultType="Map">
		SELECT
			-- 현금수입
			NVL(FC_CHG_FORMAT(SUM(OFC_FARE), 4), 0) AS OFC_FARE,
			NVL(FC_CHG_FORMAT(SUM(OFC_CNT), 4), 0) AS OFC_CNT,
			-- 차로제어기(선후불)
			NVL(FC_CHG_FORMAT(SUM(TCS_EPCARD_FARE), 4), 0) AS TCS_EPCARD_FARE,
			NVL(FC_CHG_FORMAT(SUM(TCS_ELCARD_FARE), 4), 0) AS TCS_ELCARD_FARE,
			NVL(FC_CHG_FORMAT(SUM(TCS_EPCARD_CNT), 4), 0) AS TCS_EPCARD_CNT,
			NVL(FC_CHG_FORMAT(SUM(TCS_ELCARD_CNT), 4), 0) AS TCS_ELCARD_CNT,
			-- 환불금 
			NVL(FC_CHG_FORMAT(SUM(EXMT_RFND_EX_FARE), 4), 0) AS EXMT_RFND_EX_FARE,
			NVL(FC_CHG_FORMAT(SUM(EXMT_RFND_BUSAN_FARE), 4), 0) AS EXMT_RFND_BUSAN_FARE,
			NVL(FC_CHG_FORMAT(SUM(EXMT_TAXI_FARE), 4), 0) AS EXMT_TAXI_FARE,
			-- 공차택시    
			NVL(FC_CHG_FORMAT(SUM(TAXI), 4), 0) AS TAXI,
			NVL(FC_CHG_FORMAT(SUM(EMPTY_TAXI), 4), 0) AS EMPTY_TAXI,
			-- 현금 하이패스(완납)
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_FARE_LIGHT), 4), 0) AS VLTN_PAY_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_FARE_SMALL), 4), 0) AS VLTN_PAY_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_FARE_BIG), 4), 0) AS VLTN_PAY_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_FARE_SPECIAL), 4), 0) AS VLTN_PAY_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_CNT_LIGHT), 4), 0) AS VLTN_PAY_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_CNT_SMALL), 4), 0) AS VLTN_PAY_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_CNT_BIG), 4), 0) AS VLTN_PAY_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PAY_CNT_SPECIAL), 4), 0) AS VLTN_PAY_CNT_SPECIAL,
			-- 선불 .하이패스    
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_FARE_LIGHT), 4), 0) AS LANE_EPCARD_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_FARE_SMALL), 4), 0) AS LANE_EPCARD_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_FARE_BIG), 4), 0) AS LANE_EPCARD_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_FARE_SPECIAL), 4), 0) AS LANE_EPCARD_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_CNT_LIGHT), 4), 0) AS LANE_EPCARD_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_CNT_SMALL), 4), 0) AS LANE_EPCARD_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_CNT_BIG), 4), 0) AS LANE_EPCARD_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(LANE_EPCARD_CNT_SPECIAL), 4), 0) AS LANE_EPCARD_CNT_SPECIAL,
			-- 선불.차로제어기, TCS_EPCARD_FARE
			-- 후불 .하이패스    
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_FARE_LIGHT), 4), 0) AS LANE_ELCARD_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_FARE_SMALL), 4), 0) AS LANE_ELCARD_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_FARE_BIG), 4), 0) AS LANE_ELCARD_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_FARE_SPECIAL), 4), 0) AS LANE_ELCARD_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_CNT_LIGHT), 4), 0) AS LANE_ELCARD_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_CNT_SMALL), 4), 0) AS LANE_ELCARD_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_CNT_BIG), 4), 0) AS LANE_ELCARD_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(LANE_ELCARD_CNT_SPECIAL), 4), 0) AS LANE_ELCARD_CNT_SPECIAL,
			-- 후불.차로제어기, TCS_ELCARD_FARE
			-- 사전등록       
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_FARE_LIGHT), 4), 0) AS VLTN_PRE_REG_FARE_LIGHT, 
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_FARE_SMALL), 4), 0) AS VLTN_PRE_REG_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_FARE_BIG), 4), 0) AS VLTN_PRE_REG_FARE_BIG, 
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_FARE_SPECIAL), 4), 0) AS VLTN_PRE_REG_FARE_SPECIAL, 
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_CNT_LIGHT), 4), 0) AS VLTN_PRE_REG_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_CNT_SMALL), 4), 0) AS VLTN_PRE_REG_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_CNT_BIG), 4), 0) AS VLTN_PRE_REG_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(VLTN_PRE_REG_CNT_SPECIAL), 4), 0) AS VLTN_PRE_REG_CNT_SPECIAL,
			-- 면제.하이패스_선불
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_EPCARD_FARE_LIGHT), 4), 0) AS EXMT_HIPASS_EPCARD_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_EPCARD_FARE_SMALL), 4), 0) AS EXMT_HIPASS_EPCARD_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_EPCARD_FARE_BIG), 4), 0) AS EXMT_HIPASS_EPCARD_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_EPCARD_FARE_SPECIAL), 4), 0) AS EXMT_HIPASS_EPCARD_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_EPCARD_CNT_LIGHT), 4), 0) AS EXMT_HIPASS_EPCARD_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_EPCARD_CNT_SMALL), 4), 0) AS EXMT_HIPASS_EPCARD_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_EPCARD_CNT_BIG), 4), 0) AS EXMT_HIPASS_EPCARD_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_EPCARD_CNT_SPECIAL), 4), 0) AS EXMT_HIPASS_EPCARD_CNT_SPECIAL,
			-- 면제.하이패스_후불
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_ELCARD_FARE_LIGHT), 4), 0) AS EXMT_HIPASS_ELCARD_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_ELCARD_FARE_SMALL), 4), 0) AS EXMT_HIPASS_ELCARD_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_ELCARD_FARE_BIG), 4), 0) AS EXMT_HIPASS_ELCARD_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_ELCARD_FARE_SPECIAL), 4), 0) AS EXMT_HIPASS_ELCARD_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_ELCARD_CNT_LIGHT), 4), 0) AS EXMT_HIPASS_ELCARD_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_ELCARD_CNT_SMALL), 4), 0) AS EXMT_HIPASS_ELCARD_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_ELCARD_CNT_BIG), 4), 0) AS EXMT_HIPASS_ELCARD_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_HIPASS_ELCARD_CNT_SPECIAL), 4), 0) AS EXMT_HIPASS_ELCARD_CNT_SPECIAL,
			-- 면제.선불출금
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_FARE_LIGHT), 4), 0) AS EXMT_EPCARD_PAY_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_FARE_SMALL), 4), 0) AS EXMT_EPCARD_PAY_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_FARE_BIG), 4), 0) AS EXMT_EPCARD_PAY_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_FARE_SPECIAL), 4), 0) AS EXMT_EPCARD_PAY_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_CNT_LIGHT), 4), 0) AS EXMT_EPCARD_PAY_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_CNT_SMALL), 4), 0) AS EXMT_EPCARD_PAY_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_CNT_BIG), 4), 0) AS EXMT_EPCARD_PAY_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_CNT_SPECIAL), 4), 0) AS EXMT_EPCARD_PAY_CNT_SPECIAL,
			-- 면제.후불출금
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_FARE_LIGHT), 4), 0) AS EXMT_ELCARD_PAY_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_FARE_SMALL), 4), 0) AS EXMT_ELCARD_PAY_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_FARE_BIG), 4), 0) AS EXMT_ELCARD_PAY_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_FARE_SPECIAL), 4), 0) AS EXMT_ELCARD_PAY_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_CNT_LIGHT), 4), 0) AS EXMT_ELCARD_PAY_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_CNT_SMALL), 4), 0) AS EXMT_ELCARD_PAY_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_CNT_BIG), 4), 0) AS EXMT_ELCARD_PAY_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_CNT_SPECIAL), 4), 0) AS EXMT_ELCARD_PAY_CNT_SPECIAL,
			-- 면제.부산시_선불
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_EPCARD_FARE_LIGHT), 4), 0) AS EXMT_BUSAN_EPCARD_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_EPCARD_FARE_SMALL), 4), 0) AS EXMT_BUSAN_EPCARD_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_EPCARD_FARE_BIG), 4), 0) AS EXMT_BUSAN_EPCARD_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_EPCARD_FARE_SPECIAL), 4), 0) AS EXMT_BUSAN_EPCARD_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_EPCARD_CNT_LIGHT), 4), 0) AS EXMT_BUSAN_EPCARD_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_EPCARD_CNT_SMALL), 4), 0) AS EXMT_BUSAN_EPCARD_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_EPCARD_CNT_BIG), 4), 0) AS EXMT_BUSAN_EPCARD_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_EPCARD_CNT_SPECIAL), 4), 0) AS EXMT_BUSAN_EPCARD_CNT_SPECIAL,
			-- 면제.부산시_후불
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_ELCARD_FARE_LIGHT), 4), 0) AS EXMT_BUSAN_ELCARD_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_ELCARD_FARE_SMALL), 4), 0) AS EXMT_BUSAN_ELCARD_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_ELCARD_FARE_BIG), 4), 0) AS EXMT_BUSAN_ELCARD_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_ELCARD_FARE_SPECIAL), 4), 0) AS EXMT_BUSAN_ELCARD_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_ELCARD_CNT_LIGHT), 4), 0) AS EXMT_BUSAN_ELCARD_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_ELCARD_CNT_SMALL), 4), 0) AS EXMT_BUSAN_ELCARD_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_ELCARD_CNT_BIG), 4), 0) AS EXMT_BUSAN_ELCARD_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_BUSAN_ELCARD_CNT_SPECIAL), 4), 0) AS EXMT_BUSAN_ELCARD_CNT_SPECIAL,
			-- 면제.선불출금.부산시
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_FARE_LIGHT), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_FARE_SMALL), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_FARE_BIG), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_FARE_SPECIAL), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_CNT_LIGHT), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_CNT_SMALL), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_CNT_BIG), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_EPCARD_PAY_BUSAN_CNT_SPECIAL), 4), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_SPECIAL,
			-- 면제.후불출금.부산시
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_BUSAN_FARE_LIGHT), 4), 0) AS EXMT_ELCARD_PAY_BUSAN_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_BUSAN_FARE_SMALL), 4), 0) AS EXMT_ELCARD_PAY_BUSAN_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_BUSAN_FARE_BIG), 4), 0) AS EXMT_ELCARD_PAY_BUSAN_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_BUSAN_FARE_SPECIAL), 4), 0) AS EXMT_ELCARD_PAY_BUSAN_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_BUSAN_CNT_LIGHT), 4), 0) AS EXMT_ELCARD_PAY_BUSAN_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_BUSAN_CNT_SMALL), 4), 0) AS EXMT_ELCARD_PAY_BUSAN_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_BUSAN_CNT_BIG), 4), 0) AS EXMT_ELCARD_PAY_BUSAN_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(EXMT_ELCARD_PAY_BUSAN_CNT_SPECIAL), 4), 0) AS EXMT_ELCARD_PAY_BUSAN_CNT_SPECIAL,
			-- 사무실(미납)    
			NVL(FC_CHG_FORMAT(SUM(UNP_FARE_LIGHT), 4), 0) AS UNP_FARE_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(UNP_FARE_SMALL), 4), 0) AS UNP_FARE_SMALL,
			NVL(FC_CHG_FORMAT(SUM(UNP_FARE_BIG), 4), 0) AS UNP_FARE_BIG,
			NVL(FC_CHG_FORMAT(SUM(UNP_FARE_SPECIAL), 4), 0) AS UNP_FARE_SPECIAL,
			NVL(FC_CHG_FORMAT(SUM(UNP_CNT_LIGHT), 4), 0) AS UNP_CNT_LIGHT,
			NVL(FC_CHG_FORMAT(SUM(UNP_CNT_SMALL), 4), 0) AS UNP_CNT_SMALL,
			NVL(FC_CHG_FORMAT(SUM(UNP_CNT_BIG), 4), 0) AS UNP_CNT_BIG,
			NVL(FC_CHG_FORMAT(SUM(UNP_CNT_SPECIAL), 4), 0) AS UNP_CNT_SPECIAL,
			-- 수수료
			NVL(MAX(CMS_EPCARD),0) AS CMS_EPCARD,
			NVL(MAX(CMS_ELCARD),0) AS CMS_ELCARD,
			NVL(MAX(CMS_CARD),0) AS CMS_CARD
		FROM 
		(
		    SELECT
		        IC_CODE, 
				WORK_DATE,
				IC_DIV,
		        -- 현금수입
		        SUM(OFC_PAY_FARE) - SUM(OFC_RFND_FARE) AS OFC_FARE,
		        SUM(OFC_PAY_CNT) - SUM(OFC_RFND_CNT) AS OFC_CNT,
		        -- 차로제어기
		        SUM(TCS_EPCARD_FARE) AS TCS_EPCARD_FARE,
		        SUM(TCS_ELCARD_FARE) AS TCS_ELCARD_FARE,
		        SUM(TCS_EPCARD_CNT) AS TCS_EPCARD_CNT,
		        SUM(TCS_ELCARD_CNT) AS TCS_ELCARD_CNT,
		        -- 환불금
		        SUM(EXMT_RFND_EX_FARE) AS EXMT_RFND_EX_FARE,
		        SUM(EXMT_RFND_BUSAN_FARE) AS EXMT_RFND_BUSAN_FARE,
		        SUM(EXMT_TAXI_FARE) AS EXMT_TAXI_FARE,
		        -- 공차택시
		        SUM(TAXI_CNT) AS TAXI,
		        SUM(EMPTY_TAXI_CNT) AS EMPTY_TAXI,
		        -- 수수료
		        (MAX(CMS_EPCARD)/100) AS CMS_EPCARD,
		        (MAX(CMS_ELCARD)/100) AS CMS_ELCARD,
		        (MAX(CMS_CARD)/100) AS CMS_CARD
		    FROM PROC_DAYFININFO_AFTER
		    WHERE IC_CODE = #{IC_CODE} 
	        <choose>
    			 <when test="START_DATE != NULL and END_DATE != NULL">
	        		AND WORK_DATE BETWEEN #{START_DATE} AND #{END_DATE}
	        	</when>
	        	<when test="YEAR != NULL">
	        		AND WORK_DATE BETWEEN #{YEAR} AND #{WORK_DATE}
	        	</when>
	        	<when test = "MONTH != NULL">
	        		AND WORK_DATE BETWEEN #{MONTH} AND #{WORK_DATE}
	        	</when>
	        	<otherwise>
		    		AND WORK_DATE = #{WORK_DATE}
	        	</otherwise>
	        </choose> 
		    GROUP BY IC_CODE, WORK_DATE, IC_DIV
		) DFI LEFT JOIN 
		(
		    SELECT
		        NVL(FARE.IC_CODE, CNT.IC_CODE) AS IC_CODE,
			    NVL(FARE.WORK_DATE, CNT.WORK_DATE) AS WORK_DATE,
			    NVL(FARE.IC_DIV, CNT.IC_DIV) AS IC_DIV,
		        -- 현금. 하이패스(완납)
		        SUM(VLTN_PAY_FARE_6) AS VLTN_PAY_FARE_LIGHT,
		        SUM(VLTN_PAY_FARE_1) AS VLTN_PAY_FARE_SMALL,
		        SUM(VLTN_PAY_FARE_2) AS VLTN_PAY_FARE_BIG,
		        SUM(VLTN_PAY_FARE_3) + SUM(VLTN_PAY_FARE_4) + SUM(VLTN_PAY_FARE_5) AS VLTN_PAY_FARE_SPECIAL,
		        SUM(VLTN_PAY_CNT_6) AS VLTN_PAY_CNT_LIGHT,
		        SUM(VLTN_PAY_CNT_1) AS VLTN_PAY_CNT_SMALL,
		        SUM(VLTN_PAY_CNT_2) AS VLTN_PAY_CNT_BIG,
		        SUM(VLTN_PAY_CNT_3) + SUM(VLTN_PAY_CNT_4) + SUM(VLTN_PAY_CNT_5)  AS VLTN_PAY_CNT_SPECIAL,
		        -- 선불.하이패스,
		        SUM(LANE_EPCARD_FARE_6) AS LANE_EPCARD_FARE_LIGHT,
		        SUM(LANE_EPCARD_FARE_1) AS LANE_EPCARD_FARE_SMALL,
		        SUM(LANE_EPCARD_FARE_2) AS LANE_EPCARD_FARE_BIG,
		        SUM(LANE_EPCARD_FARE_3) + SUM(LANE_EPCARD_FARE_4) + SUM(LANE_EPCARD_FARE_5) AS LANE_EPCARD_FARE_SPECIAL,
		        SUM(LANE_EPCARD_CNT_6) AS LANE_EPCARD_CNT_LIGHT,
		        SUM(LANE_EPCARD_CNT_1) AS LANE_EPCARD_CNT_SMALL,
		        SUM(LANE_EPCARD_CNT_2) AS LANE_EPCARD_CNT_BIG,
		        SUM(LANE_EPCARD_CNT_3) + SUM(LANE_EPCARD_CNT_4) + SUM(LANE_EPCARD_CNT_5) AS LANE_EPCARD_CNT_SPECIAL,
		        -- 후불.하이패스
		        SUM(LANE_ELCARD_FARE_6) AS LANE_ELCARD_FARE_LIGHT,
		        SUM(LANE_ELCARD_FARE_1) AS LANE_ELCARD_FARE_SMALL,
		        SUM(LANE_ELCARD_FARE_2) AS LANE_ELCARD_FARE_BIG,
		        SUM(LANE_ELCARD_FARE_3) + SUM(LANE_ELCARD_FARE_4) + SUM(LANE_ELCARD_FARE_5) AS LANE_ELCARD_FARE_SPECIAL,
		        SUM(LANE_ELCARD_CNT_6) AS LANE_ELCARD_CNT_LIGHT,
		        SUM(LANE_ELCARD_CNT_1) AS LANE_ELCARD_CNT_SMALL,
		        SUM(LANE_ELCARD_CNT_2) AS LANE_ELCARD_CNT_BIG,
		        SUM(LANE_ELCARD_CNT_3) + SUM(LANE_ELCARD_CNT_4) + SUM(LANE_ELCARD_CNT_5) AS LANE_ELCARD_CNT_SPECIAL,
		        -- 사전등록
		        SUM(VLTN_PRE_REG_FARE_6) AS VLTN_PRE_REG_FARE_LIGHT,
		        SUM(VLTN_PRE_REG_FARE_1) AS VLTN_PRE_REG_FARE_SMALL,
		        SUM(VLTN_PRE_REG_FARE_2) AS VLTN_PRE_REG_FARE_BIG,
		        SUM(VLTN_PRE_REG_FARE_3) + SUM(VLTN_PRE_REG_FARE_4) + SUM(VLTN_PRE_REG_FARE_5) AS VLTN_PRE_REG_FARE_SPECIAL,
		        SUM(VLTN_PRE_REG_CNT_6) AS VLTN_PRE_REG_CNT_LIGHT,
		        SUM(VLTN_PRE_REG_CNT_1) AS VLTN_PRE_REG_CNT_SMALL,
		        SUM(VLTN_PRE_REG_CNT_2) AS VLTN_PRE_REG_CNT_BIG,
		        SUM(VLTN_PRE_REG_CNT_3) + SUM(VLTN_PRE_REG_CNT_4) + SUM(VLTN_PRE_REG_CNT_5) AS VLTN_PRE_REG_CNT_SPECIAL,
		        -- 면제.하이패스_선불
		        SUM(EXMT_HIPASS_EPCARD_FARE_6) AS EXMT_HIPASS_EPCARD_FARE_LIGHT,
		        SUM(EXMT_HIPASS_EPCARD_FARE_1) AS EXMT_HIPASS_EPCARD_FARE_SMALL,
		        SUM(EXMT_HIPASS_EPCARD_FARE_2) AS EXMT_HIPASS_EPCARD_FARE_BIG,
		        SUM(EXMT_HIPASS_EPCARD_FARE_3) + SUM(EXMT_HIPASS_EPCARD_FARE_4) + SUM(EXMT_HIPASS_EPCARD_FARE_5) AS EXMT_HIPASS_EPCARD_FARE_SPECIAL,
		        SUM(EXMT_HIPASS_EPCARD_CNT_6) AS EXMT_HIPASS_EPCARD_CNT_LIGHT,
		        SUM(EXMT_HIPASS_EPCARD_CNT_1) AS EXMT_HIPASS_EPCARD_CNT_SMALL,
		        SUM(EXMT_HIPASS_EPCARD_CNT_2) AS EXMT_HIPASS_EPCARD_CNT_BIG,
		        SUM(EXMT_HIPASS_EPCARD_CNT_3) + SUM(EXMT_HIPASS_EPCARD_CNT_4) + SUM(EXMT_HIPASS_EPCARD_CNT_5) AS EXMT_HIPASS_EPCARD_CNT_SPECIAL,
		        -- 면제.하이패스_후불
		        SUM(EXMT_HIPASS_ELCARD_FARE_6) AS EXMT_HIPASS_ELCARD_FARE_LIGHT,
		        SUM(EXMT_HIPASS_ELCARD_FARE_1) AS EXMT_HIPASS_ELCARD_FARE_SMALL,
		        SUM(EXMT_HIPASS_ELCARD_FARE_2) AS EXMT_HIPASS_ELCARD_FARE_BIG,
		        SUM(EXMT_HIPASS_ELCARD_FARE_3) + SUM(EXMT_HIPASS_ELCARD_FARE_4) + SUM(EXMT_HIPASS_ELCARD_FARE_5) AS EXMT_HIPASS_ELCARD_FARE_SPECIAL,
		        SUM(EXMT_HIPASS_ELCARD_CNT_6) AS EXMT_HIPASS_ELCARD_CNT_LIGHT,
		        SUM(EXMT_HIPASS_ELCARD_CNT_1) AS EXMT_HIPASS_ELCARD_CNT_SMALL,
		        SUM(EXMT_HIPASS_ELCARD_CNT_2) AS EXMT_HIPASS_ELCARD_CNT_BIG,
		        SUM(EXMT_HIPASS_ELCARD_CNT_3) + SUM(EXMT_HIPASS_ELCARD_CNT_4) + SUM(EXMT_HIPASS_ELCARD_CNT_5) AS EXMT_HIPASS_ELCARD_CNT_SPECIAL,
				-- 면제.선불출금
				SUM(EXMT_EPCARD_PAY_FARE_6) AS EXMT_EPCARD_PAY_FARE_LIGHT,
				SUM(EXMT_EPCARD_PAY_FARE_1) AS EXMT_EPCARD_PAY_FARE_SMALL,
				SUM(EXMT_EPCARD_PAY_FARE_2) AS EXMT_EPCARD_PAY_FARE_BIG,
				SUM(EXMT_EPCARD_PAY_FARE_3) + SUM(EXMT_EPCARD_PAY_FARE_4) + SUM(EXMT_EPCARD_PAY_FARE_5) AS EXMT_EPCARD_PAY_FARE_SPECIAL,
				SUM(EXMT_EPCARD_PAY_CNT_6) AS EXMT_EPCARD_PAY_CNT_LIGHT,
				SUM(EXMT_EPCARD_PAY_CNT_1) AS EXMT_EPCARD_PAY_CNT_SMALL,
				SUM(EXMT_EPCARD_PAY_CNT_2) AS EXMT_EPCARD_PAY_CNT_BIG,
				SUM(EXMT_EPCARD_PAY_CNT_3) + SUM(EXMT_EPCARD_PAY_CNT_4) + SUM(EXMT_EPCARD_PAY_CNT_5) AS EXMT_EPCARD_PAY_CNT_SPECIAL,
				-- 면제.후불출금
				SUM(EXMT_ELCARD_PAY_FARE_6) AS EXMT_ELCARD_PAY_FARE_LIGHT,
				SUM(EXMT_ELCARD_PAY_FARE_1) AS EXMT_ELCARD_PAY_FARE_SMALL,
				SUM(EXMT_ELCARD_PAY_FARE_2) AS EXMT_ELCARD_PAY_FARE_BIG,
				SUM(EXMT_ELCARD_PAY_FARE_3) + SUM(EXMT_ELCARD_PAY_FARE_4) + SUM(EXMT_ELCARD_PAY_FARE_5) AS EXMT_ELCARD_PAY_FARE_SPECIAL,
				SUM(EXMT_ELCARD_PAY_CNT_6) AS EXMT_ELCARD_PAY_CNT_LIGHT,
				SUM(EXMT_ELCARD_PAY_CNT_1) AS EXMT_ELCARD_PAY_CNT_SMALL,
				SUM(EXMT_ELCARD_PAY_CNT_2) AS EXMT_ELCARD_PAY_CNT_BIG,
				SUM(EXMT_ELCARD_PAY_CNT_3) + SUM(EXMT_ELCARD_PAY_CNT_4) + SUM(EXMT_ELCARD_PAY_CNT_5) AS EXMT_ELCARD_PAY_CNT_SPECIAL,
		        -- 면제.부산시_선불
		        SUM(EXMT_BUSAN_EPCARD_FARE_6) AS EXMT_BUSAN_EPCARD_FARE_LIGHT,
		        SUM(EXMT_BUSAN_EPCARD_FARE_1) AS EXMT_BUSAN_EPCARD_FARE_SMALL,
		        SUM(EXMT_BUSAN_EPCARD_FARE_2) AS EXMT_BUSAN_EPCARD_FARE_BIG,
		        SUM(EXMT_BUSAN_EPCARD_FARE_3) + SUM(EXMT_BUSAN_EPCARD_FARE_4) + SUM(EXMT_BUSAN_EPCARD_FARE_5) AS EXMT_BUSAN_EPCARD_FARE_SPECIAL,
		        SUM(EXMT_BUSAN_EPCARD_CNT_6) AS EXMT_BUSAN_EPCARD_CNT_LIGHT,
		        SUM(EXMT_BUSAN_EPCARD_CNT_1) AS EXMT_BUSAN_EPCARD_CNT_SMALL,
		        SUM(EXMT_BUSAN_EPCARD_CNT_2) AS EXMT_BUSAN_EPCARD_CNT_BIG,
		        SUM(EXMT_BUSAN_EPCARD_CNT_3) + SUM(EXMT_BUSAN_EPCARD_CNT_4) + SUM(EXMT_BUSAN_EPCARD_CNT_5) AS EXMT_BUSAN_EPCARD_CNT_SPECIAL,
		        -- 면제.부산시_후불
		        SUM(EXMT_BUSAN_ELCARD_FARE_6) AS EXMT_BUSAN_ELCARD_FARE_LIGHT,
		        SUM(EXMT_BUSAN_ELCARD_FARE_1) AS EXMT_BUSAN_ELCARD_FARE_SMALL,
		        SUM(EXMT_BUSAN_ELCARD_FARE_2) AS EXMT_BUSAN_ELCARD_FARE_BIG,
		        SUM(EXMT_BUSAN_ELCARD_FARE_3) + SUM(EXMT_BUSAN_ELCARD_FARE_4) + SUM(EXMT_BUSAN_ELCARD_FARE_5) AS EXMT_BUSAN_ELCARD_FARE_SPECIAL,
		        SUM(EXMT_BUSAN_ELCARD_CNT_6) AS EXMT_BUSAN_ELCARD_CNT_LIGHT,
		        SUM(EXMT_BUSAN_ELCARD_CNT_1) AS EXMT_BUSAN_ELCARD_CNT_SMALL,
		        SUM(EXMT_BUSAN_ELCARD_CNT_2) AS EXMT_BUSAN_ELCARD_CNT_BIG,
		        SUM(EXMT_BUSAN_ELCARD_CNT_3) + SUM(EXMT_BUSAN_ELCARD_CNT_4) + SUM(EXMT_BUSAN_ELCARD_CNT_5) AS EXMT_BUSAN_ELCARD_CNT_SPECIAL,
				-- 면제.선불출금.부산시
				SUM(EXMT_EPCARD_PAY_BUSAN_FARE_6) AS EXMT_EPCARD_PAY_BUSAN_FARE_LIGHT,
				SUM(EXMT_EPCARD_PAY_BUSAN_FARE_1) AS EXMT_EPCARD_PAY_BUSAN_FARE_SMALL,
				SUM(EXMT_EPCARD_PAY_BUSAN_FARE_2) AS EXMT_EPCARD_PAY_BUSAN_FARE_BIG,
				SUM(EXMT_EPCARD_PAY_BUSAN_FARE_3) + SUM(EXMT_EPCARD_PAY_BUSAN_FARE_4) + SUM(EXMT_EPCARD_PAY_BUSAN_FARE_5) AS EXMT_EPCARD_PAY_BUSAN_FARE_SPECIAL,
				SUM(EXMT_EPCARD_PAY_BUSAN_CNT_6) AS EXMT_EPCARD_PAY_BUSAN_CNT_LIGHT,
				SUM(EXMT_EPCARD_PAY_BUSAN_CNT_1) AS EXMT_EPCARD_PAY_BUSAN_CNT_SMALL,
				SUM(EXMT_EPCARD_PAY_BUSAN_CNT_2) AS EXMT_EPCARD_PAY_BUSAN_CNT_BIG,
				SUM(EXMT_EPCARD_PAY_BUSAN_CNT_3) + SUM(EXMT_EPCARD_PAY_BUSAN_CNT_4) + SUM(EXMT_EPCARD_PAY_BUSAN_CNT_5) AS EXMT_EPCARD_PAY_BUSAN_CNT_SPECIAL,
				-- 면제.후불출금.부산시
				SUM(EXMT_ELCARD_PAY_BUSAN_FARE_6) AS EXMT_ELCARD_PAY_BUSAN_FARE_LIGHT,
				SUM(EXMT_ELCARD_PAY_BUSAN_FARE_1) AS EXMT_ELCARD_PAY_BUSAN_FARE_SMALL,
				SUM(EXMT_ELCARD_PAY_BUSAN_FARE_2) AS EXMT_ELCARD_PAY_BUSAN_FARE_BIG,
				SUM(EXMT_ELCARD_PAY_BUSAN_FARE_3) + SUM(EXMT_ELCARD_PAY_BUSAN_FARE_4) + SUM(EXMT_ELCARD_PAY_BUSAN_FARE_5) AS EXMT_ELCARD_PAY_BUSAN_FARE_SPECIAL,
				SUM(EXMT_ELCARD_PAY_BUSAN_CNT_6) AS EXMT_ELCARD_PAY_BUSAN_CNT_LIGHT,
				SUM(EXMT_ELCARD_PAY_BUSAN_CNT_1) AS EXMT_ELCARD_PAY_BUSAN_CNT_SMALL,
				SUM(EXMT_ELCARD_PAY_BUSAN_CNT_2) AS EXMT_ELCARD_PAY_BUSAN_CNT_BIG,
				SUM(EXMT_ELCARD_PAY_BUSAN_CNT_3) + SUM(EXMT_ELCARD_PAY_BUSAN_CNT_4) + SUM(EXMT_ELCARD_PAY_BUSAN_CNT_5) AS EXMT_ELCARD_PAY_BUSAN_CNT_SPECIAL,
		        -- 사무실(미납)
		        SUM(UNP_FARE_6) AS UNP_FARE_LIGHT,
		        SUM(UNP_FARE_1) AS UNP_FARE_SMALL,
		        SUM(UNP_FARE_2) AS UNP_FARE_BIG,
		        SUM(UNP_FARE_3) + SUM(UNP_FARE_4) + SUM(UNP_FARE_5) AS UNP_FARE_SPECIAL,
		        SUM(UNP_CNT_6) AS UNP_CNT_LIGHT,
		        SUM(UNP_CNT_1) AS UNP_CNT_SMALL,
		        SUM(UNP_CNT_2) AS UNP_CNT_BIG,
		        SUM(UNP_CNT_3) + SUM(UNP_CNT_4) + SUM(UNP_CNT_5) AS UNP_CNT_SPECIAL
		    FROM
		    (
		        SELECT 
		            IC_CODE,
		            WORK_DATE,
		            IC_DIV,
		            DFT_CAR_TYPE,
		            -- 현금.하이패스(완납)
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_CNT_6,
		            -- 선불.하이패스
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_CNT_6,
		            -- 후불.하이패스,
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_CNT_6,
		            -- 사전등록
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_CNT_6,
		            -- 면제.하이패스_선불
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_CNT_6,
		            -- 면제.하이패스_후불
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_CNT_6,
					-- 면제.선불출금
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_CNT_6,
		            -- 면제.후불출금
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_CNT_6,
		            -- 면제.부산시_선불
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_CNT_6,
		            -- 면제.부산시_후불
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_CNT_6,
					-- 면제.선불출금.부산시
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_CNT_6,
		            -- 면제.후불출금.부산시
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_CNT_6,
		            -- 사무실(미납)
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_CNT_6
		        FROM
		            PROC_DAYFINPAYTOT_AFTER
		        WHERE IC_CODE = #{IC_CODE}
					<choose>
	       			 	<when test="START_DATE != NULL and END_DATE != NULL">
			        		AND WORK_DATE BETWEEN #{START_DATE} AND #{END_DATE}
			        	</when>
			        	<when test="YEAR != NULL">
			        		AND WORK_DATE BETWEEN #{YEAR} AND #{WORK_DATE}
			        	</when>
			        	<when test = "MONTH != NULL">
			        		AND WORK_DATE BETWEEN #{MONTH} AND #{WORK_DATE}
			        	</when>
			        	<otherwise>
				    		AND WORK_DATE = #{WORK_DATE}
			        	</otherwise>
			        </choose>
			        AND SUM_DIV = '0'
		        GROUP BY IC_CODE, WORK_DATE, IC_DIV, DFT_CAR_TYPE
		    ) CNT LEFT JOIN
	     	(
	        	SELECT 
		            IC_CODE,
		            WORK_DATE,
		            IC_DIV,
		            DFT_CAR_TYPE,
		            -- 현금.하이패스(완납)
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_PAY_CASH) + SUM(VLTN_PAY_ACNT) + SUM(VLTN_DC_PAY_CASH) + SUM(VLTN_DC_PAY_ACNT), 0) AS VLTN_PAY_FARE_6,
		            -- 선불.하이패스
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_PAY_EPCARD_ETC) + SUM(LANE_PAY_CMTDC_EPCARD_ETC) + SUM(LANE_PAY_CNTDC_EPCARD_ETC) + SUM(VLTN_NOML_EPCARD) + SUM(VLTN_DC_NOML_EPCARD), 0) AS LANE_EPCARD_FARE_6,
		            -- 후불.하이패스
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_PAY_ELCARD_ETC) + SUM(LANE_PAY_CMTDC_ELCARD_ETC) + SUM(LANE_PAY_CNTDC_ELCARD_ETC) + SUM(VLTN_NOML_ELCARD) +  + SUM(VLTN_DC_NOML_ELCARD), 0) AS LANE_ELCARD_FARE_6,
		            -- 사전등록
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_PRE_REG) + SUM(VLTN_DC_PRE_REG), 0) AS VLTN_PRE_REG_FARE_6,
		           	-- 면제.하이패스_선불
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_OBU_EPCARD_ETC) + SUM(LANE_EXEM_CARD_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD), 0) AS EXMT_HIPASS_EPCARD_FARE_6,
		            -- 면제.하이패스_후불
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_OBU_ELCARD_ETC) + SUM(LANE_EXEM_CARD_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD), 0) AS EXMT_HIPASS_ELCARD_FARE_6,
					-- 면제.선불출금
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_EPCARD_PAY), 0) AS EXMT_EPCARD_PAY_FARE_6,
		            -- 면제.후불출금
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_ELCARD_PAY), 0) AS EXMT_ELCARD_PAY_FARE_6,
		            -- 면제.부산시_선불
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_BUSAN_EPCARD_ETC) + SUM(VLTN_EXMT_EPCARD_BUSAN),0) AS EXMT_BUSAN_EPCARD_FARE_6,
		            -- 면제.부산시_후불
		            DECODE(DFT_CAR_TYPE, 1, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(LANE_EXEM_BUSAN_ELCARD_ETC) + SUM(VLTN_EXMT_ELCARD_BUSAN),0) AS EXMT_BUSAN_ELCARD_FARE_6,
					-- 면제.선불출금.부산시
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_EPCARD_PAY_BUSAN), 0) AS EXMT_EPCARD_PAY_BUSAN_FARE_6,
		            -- 면제.후불출금.부산시
		            DECODE(DFT_CAR_TYPE, 1, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(EXMT_ELCARD_PAY_BUSAN), 0) AS EXMT_ELCARD_PAY_BUSAN_FARE_6,
		            -- 사무실(미납)
		            DECODE(DFT_CAR_TYPE, 1, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_1,
		            DECODE(DFT_CAR_TYPE, 2, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_2,
		            DECODE(DFT_CAR_TYPE, 3, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_3,
		            DECODE(DFT_CAR_TYPE, 4, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_4,
		            DECODE(DFT_CAR_TYPE, 5, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_5,
		            DECODE(DFT_CAR_TYPE, 6, SUM(VLTN_UNP) + SUM(EXMT_UNP) + SUM(VLTN_DC_UNP), 0) AS UNP_FARE_6
		        FROM
		            PROC_DAYFINPAYTOT_AFTER
		        WHERE IC_CODE = #{IC_CODE} 
					<choose>
	       			 	<when test="START_DATE != NULL and END_DATE != NULL">
			        		AND WORK_DATE BETWEEN #{START_DATE} AND #{END_DATE}
			        	</when>
			        	<when test="YEAR != NULL">
			        		AND WORK_DATE BETWEEN #{YEAR} AND #{WORK_DATE}
			        	</when>
			        	<when test = "MONTH != NULL">
			        		AND WORK_DATE BETWEEN #{MONTH} AND #{WORK_DATE}
			        	</when>
			        	<otherwise>
				    		AND WORK_DATE = #{WORK_DATE}
		        		</otherwise>
			        </choose>
			        AND SUM_DIV = '1'
		        GROUP BY IC_CODE, WORK_DATE, IC_DIV, DFT_CAR_TYPE
		    ) FARE ON FARE.IC_CODE = CNT.IC_CODE AND FARE.WORK_DATE = CNT.WORK_DATE AND FARE.DFT_CAR_TYPE = CNT.DFT_CAR_TYPE AND FARE.IC_DIV = CNT.IC_DIV
		    GROUP BY FARE.IC_CODE, FARE.WORK_DATE, CNT.IC_CODE, CNT.WORK_DATE, FARE.IC_DIV, CNT.IC_DIV
		) DFT ON DFI.IC_CODE = DFT.IC_CODE AND DFI.WORK_DATE = DFT.WORK_DATE AND DFI.IC_DIV = DFT.IC_DIV
		<if test='IC_DIV!=null and !IC_DIV.equals("")'>
			WHERE DFI.IC_DIV = #{IC_DIV}
		</if>
		GROUP BY DFI.IC_CODE
	</select>
	
	<select id="selectImageList" parameterType="Map" resultType="Map">
		SELECT 
		    IC_CODE, WORK_DATE, WORK_NO, HAND_SNO, CASE WHEN (VLTN_CODE = '00' AND EXM_DIV = '0' AND BS_EXM_TYPE_DIV ='0') THEN 2 ELSE 1 END AS AUDIT_STATUS
		FROM 
		    PRIM_ETCHAND
		WHERE 1=1
			AND IC_CODE = '094'
			AND (
			<foreach item="item" collection="param" open="" close="" separator="OR">
           		(WORK_DATE = #{item.WORK_DATE} AND WORK_NO = #{item.WORK_NO} AND HAND_SNO = #{item.HAND_SNO})
        	</foreach>
        	)
	</select>
</mapper>